<?xml version="1.0" encoding="utf-8"?>
<coll name="ContentWifis" title="Adjuntos" sql-debug="true" sql="" objname="" updateobj="" progid="ASData.CASBasicDataObj" loadall="true" cell-height="122p" cell-odd-color="#00000000" cell-even-color="#00000000" special="true">
  <group name="Invisibles" id="1" />
  <frame group="1" name="frmTaareaCabecer" align="center|left" width="100%" height="100%" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_IMAGE" type="IMG" visible="4" width="120p" height="120p" labelwidth="0" />
  <frame group="1" frame="frmTaareaCabecer" name="frmInfo" align="center" width="100%" height="120p" newline="false" />
  <prop group="1" frame="frmInfo" name="MAP_SSID" textfont-bold="true" textfont-size="8" type="T" visible="4" width="600p" labelwidth="0" text-align="left|center" size="20" newline="false" />
  <prop group="1" frame="frmInfo" name="MAP_ESTADO" textfont-size="5" type="T" visible="4" width="600p" labelwidth="0" text-align="left|center" size="20" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_SEPARATE" type="TL" visible="4" width="100%" height="2p" bgcolor="#666666" title="ffff" labelbox="true" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_SECURITY" type="T" visible="0" class="celdaContent" width="28%" textfont-size="7" text-align="right|center" size="20" newline="false" height="30%" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_FRMOLVIDADA" type="N" visible="0" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_COLOR" type="T" visible="0" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_ORDEN" type="N" visible="0" />
  <prop group="1" frame="frmTaareaCabecer" name="MAP_IDESTADO" type="N" visible="0" />
  <selecteditem show-wait-dialog="true" refresh="false">
    <action name="runscript">
      <script language="javascript">
			try
			{
				var parent = self.getOwnerCollection().getOwnerObject();
				var view = ui.getView(self.getOwnerCollection().getOwnerObject());
				var wifiManager = createObject("WifiManager");
				
				if(self.MAP_IDESTADO == 1){
				    // significa que es la wifi en la que estamos conectados ...
				    parent.MAP_WIFICONECTEDINFO = 1;
				    var wifiActiveInfo = wifiManager.getActiveWifiInfo();
				    if(wifiActiveInfo != null){
				        parent.MAP_SSID_INFO = self.MAP_SSID;
				        parent.MAP_ESTADO_INFO = self.MAP_ESTADO;
				        parent.MAP_INTENSIDAD_INFO = wifiActiveInfo.getRssi();
				        // La velocidad se devuelve en Mbps
				        parent.MAP_VELOCIDAD_INFO = wifiActiveInfo.getLinkSpeed() + "Mbps";
				        // La frecuencuia se devuelve en MHz
				        parent.MAP_FRECUENCIA_INFO = (wifiActiveInfo.getFrequency()/1000) + "GHz";
				        parent.MAP_SEGURIDAD_INFO = self.MAP_SECURITY;
				    }
				    view.refreshAll("frmWifiConectedInfo,frmWifiConectedInfoG");
				}else if (self.MAP_IDESTADO == 0){
				    // significa que es una wifi que tenemos guardada pero no estamos conectados ...
				    parent.MAP_WIFISAVE = 1;
				    parent.MAP_SSID_SAVE = self.MAP_SSID;
				    view.refreshAll("frmWifiSave,frmWifiSaveG");
				}else if (self.MAP_IDESTADO == -1){
				    // significa que es una wifi que ni estamos conectados ni la tenemos guardada ...
				    parent.MAP_WIFINEW = 1;
				    parent.MAP_SSID_NEW = self.MAP_SSID;
				    view.refreshAll("frmWifiNew,frmWifiNewG");
				}
				
				parent.MAP_SECURITY = self.MAP_SECURITY;
				
				/*
				self.getOwnerCollection().getOwnerObject().MAP_SELECCION=1;
				self.getOwnerCollection().getOwnerObject().MAP_SSID=self.MAP_SSID;
				self.getOwnerCollection().getOwnerObject().MAP_SECURITY=self.MAP_SECURITY;
				self.getOwnerCollection().getOwnerObject().MAP_ESTADO=self.MAP_ESTADO;
				self.getOwnerCollection().getOwnerObject().MAP_PWD="";
				
				
				if (self.MAP_ESTADO=="Conectada" || self.MAP_ESTADO=="Guardada, Protegida" || self.MAP_ESTADO=="Guardada, Abierta" || self.MAP_ESTADO=="Abierta")
				{
					self.getOwnerCollection().getOwnerObject().MAP_SELECCION1=1;
				}
				else
				{
					self.getOwnerCollection().getOwnerObject().MAP_SELECCION1=0;
				}
					
				if (self.MAP_ESTADO=="Conectada")
					self.MAP_COLOR="#5B9BD5";
				else
					self.MAP_COLOR="#D2DEEF";*/
				
				//ui.refresh(MAP_TXT_TITLE3,MAP_OLVIDAR);
  				
		    }
      		catch(ex){
					
			}
		  </script>
    </action>
  </selecteditem>
</coll>